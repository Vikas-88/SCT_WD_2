 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Advanced Calculator</title>

<style>
/* ===== RESET ===== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Segoe UI", sans-serif;
}

/* ===== THEME VARIABLES ===== */
:root {
  --glass-bg: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.35);
  --text: #ffffff;
  --btn-bg: rgba(255, 255, 255, 0.15);
}

body.light {
  --glass-bg: rgba(255, 255, 255, 0.7);
  --glass-border: rgba(255, 255, 255, 0.45);
  --text: #0f172a;
  --btn-bg: rgba(0, 0, 0, 0.05);
}

body {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #020617, #020617);
  color: var(--text);
}

body.light {
  background: linear-gradient(135deg, #fdfbfb, #ebedee);
}

/* ===== CONTAINER ===== */
.calculator-container {
  display: flex;
  gap: 1.5rem;
}

/* ===== CALCULATOR ===== */
.calculator {
  width: 340px;
  padding: 20px;
  border-radius: 20px;
  background: var(--glass-bg);
  backdrop-filter: blur(16px);
  border: 1px solid var(--glass-border);
  box-shadow: 0 20px 40px rgba(0,0,0,0.35);
}

.display {
  width: 100%;
  height: 60px;
  margin-bottom: 12px;
  font-size: 1.6rem;
  text-align: right;
  padding: 10px;
  border-radius: 10px;
  border: none;
  background: rgba(0,0,0,0.25);
  color: var(--text);
}

/* ===== BUTTON GRID ===== */
.buttons {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
}

button {
  height: 48px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  background: var(--btn-bg);
  color: var(--text);
  font-size: 1rem;
  transition: transform 0.2s ease;
}

button:hover {
  transform: translateY(-2px);
}

.operator { background: #2563eb; }
.equal { background: #22c55e; font-weight: 700; color: #020617; }
.clear { background: #ef4444; }

/* ===== HISTORY ===== */
.history {
  width: 220px;
  padding: 16px;
  border-radius: 20px;
  background: var(--glass-bg);
  backdrop-filter: blur(16px);
  border: 1px solid var(--glass-border);
}

.history h3 {
  margin-bottom: 0.8rem;
}

.history ul {
  list-style: none;
  max-height: 320px;
  overflow-y: auto;
}

.history li {
  font-size: 0.85rem;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

/* ===== THEME TOGGLE ===== */
.theme-toggle {
  margin-bottom: 10px;
  width: 100%;
  background: transparent;
  border: 1px solid var(--glass-border);
}
</style>
</head>

<body>

<div class="calculator-container">

  <!-- CALCULATOR -->
  <div class="calculator">
    <button class="theme-toggle" id="themeToggle">ðŸŒ™ Toggle Theme</button>
    <input type="text" id="display" class="display" readonly />

    <div class="buttons">
      <button class="clear">C</button>
      <button>âŒ«</button>
      <button>(</button>
      <button>)</button>
      <button class="operator">/</button>

      <button>sin</button>
      <button>cos</button>
      <button>tan</button>
      <button>âˆš</button>
      <button class="operator">*</button>

      <button>7</button>
      <button>8</button>
      <button>9</button>
      <button>^</button>
      <button class="operator">-</button>

      <button>4</button>
      <button>5</button>
      <button>6</button>
      <button>%</button>
      <button class="operator">+</button>

      <button>1</button>
      <button>2</button>
      <button>3</button>
      <button class="equal">=</button>
      <button>0</button>
    </div>
  </div>

  <!-- HISTORY PANEL -->
  <div class="history">
    <h3>History</h3>
    <ul id="historyList"></ul>
  </div>

</div>

<script>
const display = document.getElementById("display");
const buttons = document.querySelectorAll(".buttons button");
const historyList = document.getElementById("historyList");
const themeToggle = document.getElementById("themeToggle");

let input = "";

/* ===== THEME ===== */
if (localStorage.theme === "light") document.body.classList.add("light");

themeToggle.onclick = () => {
  document.body.classList.toggle("light");
  localStorage.theme = document.body.classList.contains("light") ? "light" : "dark";
};

/* ===== BUTTON HANDLING ===== */
buttons.forEach(btn => {
  btn.addEventListener("click", () => handleInput(btn.textContent));
});

/* ===== KEYBOARD ===== */
document.addEventListener("keydown", e => {
  if ("0123456789+-*/().%".includes(e.key)) input += e.key;
  else if (e.key === "Enter") calculate();
  else if (e.key === "Backspace") input = input.slice(0, -1);
  display.value = input;
});

/* ===== INPUT HANDLER ===== */
function handleInput(value) {
  if (value === "C") input = "";
  else if (value === "âŒ«") input = input.slice(0, -1);
  else if (value === "=") return calculate();
  else if (value === "âˆš") input += "Math.sqrt(";
  else if (["sin","cos","tan"].includes(value)) input += `Math.${value}(`;
  else if (value === "^") input += "**";
  else input += value;

  display.value = input;
}

/* ===== CALCULATION ===== */
function calculate() {
  try {
    const result = eval(input);
    if (!isFinite(result)) throw Error();

    addHistory(input, result);
    display.value = result;
    input = result.toString();
  } catch {
    display.value = "Error";
    input = "";
  }
}

/* ===== HISTORY ===== */
function addHistory(expr, result) {
  const li = document.createElement("li");
  li.textContent = `${expr} = ${result}`;
  li.onclick = () => {
    input = result.toString();
    display.value = input;
  };
  historyList.prepend(li);
}
</script>

</body>
</html>
